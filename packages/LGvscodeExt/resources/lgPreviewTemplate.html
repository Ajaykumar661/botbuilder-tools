<!DOCTYPE html>
<html lang="en">
<head>
  <title>Language Generation Tester</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style type="text/css"> 
    h1 {
      font-weight: normal;
      padding: 0;
      margin: 0;
    }

    input[type="submit"] {
      background: rgba(43,103,212,1);
      color: #FFF;
      border: none;
      padding: 0.5rem 3rem;
    }

    textarea, input[type="text"] {
      width: 100%;
      font-size: 1rem;
    }

    .panes > div {
      flex-basis: 50%;
      margin: 1rem;
    }

    .results {
      border-top: 2px dashed #666;
      padding-top: 1rem;
      margin: 0;
      margin-top: 1rem;
    }

    .results li {
      margin-bottom: 1rem;
    }
  </style> 
</head>

<body>
  <header>
      <h1>
        Language Generation Tester
      </h1>
      <p>
        Preview the <a href="https://github.com/microsoft/BotBuilder-Samples/blob/master/experimental/language-generation" target="_new">experimental Bot Framework language generation library</a> 
        with this interactive tool that will use your LG rules to generate example language.
        This library is intended for use in generating personalized, contextual responses for bots and other conversational software.
      </p>
    </header>

    <div class="panes">
    <div>
      <p>
        <label for="json">Values used to evaluate expressions (must be valid json)</label>
        <textarea name="json" rows="15" id="json">{"name":"ms"}</textarea>
      </p>
      <p>
        <label for="text">Template Name</label>
        <input type="text" name="text" id="template" placeholder="The name of a template from the LG file" value="" onkeypress="document.getElementById('freetext').value='';"/>
      </p>
      <p>
        <label for="text">Free Text</label>
        <input type="text" name="freetext" id="freetext" placeholder="Text to evaluate as a template" value="" onkeypress="document.getElementById('template').value='';"/>
      </p>
      <p>
        <label for="interations">Generate # of variants:</label>
        <input type="number" id="iterations" name="iterations" value="1"/>
      </p>

      <input type="submit" onclick="submitScope()" value="Generate">

      <div class="results">
        <label>Generated Language</label>

        <ol>
          <div id="evaluateresults"> </div>
        </ol>
      </div>
    </div>
  </div>
  <script>
        var vscode = undefined;
        function submitScope() {
            const scopeValue = document.getElementById('json').value;
            const templateName = document.getElementById('template').value;
            const inlineText = document.getElementById('freetext').value;
            const iterations = document.getElementById('iterations').value;
            const resultEl = document.getElementById('evaluateresults');
            if(vscode === undefined) {
                vscode = acquireVsCodeApi();
            }

            resultEl.innerHTML = '';

            vscode.postMessage({
                command: 'passScope',
                scopeValue: scopeValue,
                templateName: templateName,
                inlineText: inlineText,
                iterations: iterations
            });
        }

        // Handle the message inside the webview
        window.addEventListener('message', event => {
            const resultEl = document.getElementById('evaluateresults');
            const message = event.data; // The JSON data our extension sent

            switch (message.command) {
                case 'evaluateResults': {
                   var arr = message.results;
                   resultEl.innerHTML = '';
                    arr.forEach(function(e) {
       		 		        resultEl.innerHTML = resultEl.innerHTML + "<li>" + e + "</li>";
           		      })
                }
            }
        });
    </script>
</body>
</html>